<!--
  Verify that a map is created when a set of fiducual transforms is sent to
  fiducial_slam
-->
<launch>
  <node name="camera_pose" pkg="tf2_ros" type="static_transform_publisher" 
        args="0.0 0.0 0.0 0.0 0.0 0.0 1.0 base_link raspicam" />

  <node type="fiducial_slam" pkg="fiducial_slam2" name="fiducial_slam">
    <param name="initial_map_file" value="$(find fiducial_slam2)/test/610_initial_map.txt" />
    <param name="map_file" value="$(find fiducial_slam2)/test/map.txt" />
    <param name="camera_frame" value="base_link" />
    <param name="odom_frame" value="" />
    <param name="pose_frame" value="base_link" />
    <param name="do_rotation" value="false" />
  </node>

  <node name="rosbag" pkg="rosbag" type="play" args="-l $(find fiducial_slam2)/test/transforms.bag">
    <remap from="/fiducial_detect/fiducial_transforms" to="/fiducial_transforms"/>  
  </node>

  <test test-name="map_test" pkg="fiducial_slam2" type="map_test.py" name="map_test1">
    <param name="map_file" value="$(find fiducial_slam2)/test/map.txt" />
    <param name="min_lines" value="6" />
  </test>
</launch>

